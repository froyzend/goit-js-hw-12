{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst apiKey = '45704413-78352b289562c0261d4e7c072';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst perPage = 15; // кількість об'єктів на сторінку\n\nexport async function getGalleryData(queryValue, page = 1) {\n  try {\n    const response = await axios.get('', {\n      params: {\n        key: apiKey,\n        q: queryValue,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: page, // параметр сторінки\n        per_page: perPage, // кількість об'єктів на сторінку\n      }\n    });\n    console.log('Response data:', response.data); // Для отладки\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching gallery data:', error);\n    iziToast.error({\n      title: 'Error',\n      message: `Ошибка: ${error.message}`,\n      position: 'topRight',\n    });\n    throw error;\n  }\n}\n","export function addLoader(gallery) {\n  const loaderHTML = '<span class=\"loader\">Loading...</span>';\n  gallery.insertAdjacentHTML('afterbegin', loaderHTML);\n}\nremoveLoader();\n\nexport function removeLoader() {\n  try {\n    const loader = document.querySelector('.loader');\n    if (loader) {\n      loader.remove();\n    }\n  } catch (error) {\n    console.error('Ошибка при удалении загрузчика:', error);\n    iziToast.error({\n      title: 'Error',\n      message: `Ошибка: ${error.message}`,\n      position: 'topRight',\n    });\n  }\n}\n\nexport function markup(data) {\n  return data.hits\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n        <li class=\"gallery-item hvr-grow\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n              loading=\"lazy\"\n            />\n          </a>\n          <ul class=\"img-content-wrapper\">\n            <li class=\"img-content-descr\">Likes<span>${likes}</span></li>\n            <li class=\"img-content-descr\">Views<span>${views}</span></li>\n            <li class=\"img-content-descr\">Comments<span>${comments}</span></li>\n            <li class=\"img-content-descr\">Downloads<span>${downloads}</span></li>\n          </ul>\n        </li>\n      `\n    )\n    .join(''); \n\n}\n\n\n","import { getGalleryData } from './js/pixabay-api';\nimport { addLoader, removeLoader, markup } from './js/render-functions';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nlet lightbox = '';\nlet searchValue = '';\nlet currentPage = 1;\n\nform.addEventListener('submit', onSubmitForm);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nfunction onSubmitForm(event) {\n  event.preventDefault();\n\n  const formData = new FormData(event.target);\n  const { searchQuery } = Object.fromEntries(formData.entries());\n  searchValue = searchQuery.trim();\n\n  if (!searchValue) {\n    iziToast.error({\n      title: 'Error',\n      message: 'The search query is empty.',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  gallery.innerHTML = '';\n  currentPage = 1; \n  addLoader(gallery); \n  loadMoreBtn.classList.add('is-hidden'); \n\n  // Проверяем и уничтожаем lightbox, только если он был инициализирован\n  if (lightbox && lightbox instanceof SimpleLightbox) {\n    lightbox.destroy();\n    lightbox = null; // Сбрасываем значение\n  }\n\n  fetchGalleryData();\n}\n\nasync function fetchGalleryData() {\n  try {\n    const data = await getGalleryData(searchValue, currentPage);\n    if (data.hits.length === 0) {\n      iziToast.info({\n        position: 'topRight',\n        title: 'Info',\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n\n    const galleryMarkup = markup(data);\n    gallery.insertAdjacentHTML('beforeend', galleryMarkup);\n\n   \n   if (!lightbox) {\n  lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n} else {\n  lightbox.refresh();\n}\n\n    // 15 img отображается показываем кнопку Load More\n    if (data.hits.length === 15) {\n      loadMoreBtn.classList.remove('is-hidden');\n    } else {\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      loadMoreBtn.classList.add('is-hidden'); // прячем кнопку\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: `Error: ${error.message}`,\n      position: 'topRight',\n    });\n  } finally {\n    removeLoader(); \n  }\n \n\n}\n\nfunction onLoadMore() {\n  currentPage += 1; \n  addLoader(gallery); \n  fetchGalleryData().then(() => {\n    const galleryItem = document.querySelector('.gallery-item');\n    \n    if (galleryItem) {\n      const cardHeight = galleryItem.getBoundingClientRect().height;\n      window.scrollBy({\n        top: cardHeight * 3,\n        behavior: 'smooth' \n      });\n    }\n  });\n}\n"],"names":["apiKey","axios","perPage","getGalleryData","queryValue","page","response","error","addLoader","gallery","removeLoader","loader","markup","data","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","loadMoreBtn","lightbox","searchValue","currentPage","onSubmitForm","onLoadMore","event","formData","searchQuery","iziToast","SimpleLightbox","fetchGalleryData","galleryMarkup","galleryItem","cardHeight"],"mappings":"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"}